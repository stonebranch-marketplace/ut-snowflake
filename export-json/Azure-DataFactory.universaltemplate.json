{
    "agent": null,
    "agentCluster": null,
    "agentClusterVar": null,
    "agentFieldsRestriction": "No Restriction",
    "agentType": "Any",
    "agentVar": null,
    "automaticOutputRetrievalFieldsRestriction": "No Restriction",
    "broadcastCluster": null,
    "broadcastClusterVar": null,
    "createConsole": false,
    "credentialFieldsRestriction": "No Restriction",
    "credentials": null,
    "credentialsVar": null,
    "description": "This Universal task to orchestrate the Azure DataFactory Pipeline runs",
    "desktopInteract": false,
    "elevateUser": false,
    "environment": [],
    "environmentVariablesFieldsRestriction": "No Restriction",
    "exitCodeOutput": null,
    "exitCodeProcessing": "Success Exitcode Range",
    "exitCodeProcessingFieldsRestriction": "No Restriction",
    "exitCodeText": null,
    "exitCodes": "0",
    "fields": [
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 10",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide the Azure cloud location",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Azure Location",
            "name": "azure_location",
            "noSpaceIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": true,
            "sequence": 0,
            "showIfField": null,
            "showIfFieldValue": null,
            "sysId": "3c217e12143544f9b3e382276309e855"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 1",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide Azure Tenant ID",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Azure Tenant ID",
            "name": "tenant_id",
            "noSpaceIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": true,
            "sequence": 1,
            "showIfField": null,
            "showIfFieldValue": null,
            "sysId": "894f618c210641419281feee0e4be4e0"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Credential Field 1",
            "fieldType": "Credential",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide the client ID and client secret(Client ID as user name and client secret as the password)",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Azure Client ID & Client Secret",
            "name": "client_id",
            "noSpaceIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": true,
            "sequence": 2,
            "showIfField": null,
            "showIfFieldValue": null,
            "sysId": "dfc18bddac334ac4afad1cef09025a63"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 2",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide Azure Subscription ID",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Azure Subscription ID",
            "name": "subscription_id",
            "noSpaceIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": true,
            "sequence": 3,
            "showIfField": null,
            "showIfFieldValue": null,
            "sysId": "efbfd5c70e7f493e84e590b5c56e56c0"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 3",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Name of the Azure Resource group",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Azure Resource Group",
            "name": "resource_group_name",
            "noSpaceIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": true,
            "sequence": 4,
            "showIfField": null,
            "showIfFieldValue": null,
            "sysId": "9c2169484a3643bc87add9995cf040a2"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [
                {
                    "fieldValue": "create_run",
                    "fieldValueLabel": "Run a Pipeline",
                    "sequence": 0,
                    "sysId": "2a6274157f06419084e77570eb0b5685",
                    "useFieldValueForLabel": false
                },
                {
                    "fieldValue": "get_pipeline",
                    "fieldValueLabel": "Get a Pipeline info",
                    "sequence": 1,
                    "sysId": "a38783267f424bf4bb9eeeeede935991",
                    "useFieldValueForLabel": false
                },
                {
                    "fieldValue": "list_pipelines",
                    "fieldValueLabel": "List all Pipelines",
                    "sequence": 2,
                    "sysId": "5f6afe0de17342fd86b38a57803da745",
                    "useFieldValueForLabel": false
                },
                {
                    "fieldValue": "cancel_run",
                    "fieldValueLabel": "Cancel Pipeline Run",
                    "sequence": 3,
                    "sysId": "edb8d6173e044bd6a142a77817cbb08e",
                    "useFieldValueForLabel": false
                },
                {
                    "fieldValue": "list_factories",
                    "fieldValueLabel": "List Factory by Resource Group",
                    "sequence": 4,
                    "sysId": "0e28a82574204ec3b1da4750bdf61e27",
                    "useFieldValueForLabel": false
                },
                {
                    "fieldValue": "start_trigger",
                    "fieldValueLabel": "Start Trigger",
                    "sequence": 5,
                    "sysId": "e97d50dc65534f9f915458063e80f8d7",
                    "useFieldValueForLabel": false
                },
                {
                    "fieldValue": "stop_trigger",
                    "fieldValueLabel": "Stop Trigger",
                    "sequence": 6,
                    "sysId": "1cb6aa456079485188e0b7fa7df46416",
                    "useFieldValueForLabel": false
                },
                {
                    "fieldValue": "list_triggers",
                    "fieldValueLabel": "List Trigger by Factory",
                    "sequence": 7,
                    "sysId": "ed8e41b1dbba46c5b397c963ab65d137",
                    "useFieldValueForLabel": false
                }
            ],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Choice Field 1",
            "fieldType": "Choice",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "from the list select an operation you would like to perform",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Datafactory Operation",
            "name": "datafactory_function",
            "noSpaceIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": false,
            "sequence": 5,
            "showIfField": null,
            "showIfFieldValue": null,
            "sysId": "670a8713890e4f90bda19f562042a23c"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 4",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide the Azure Data Factory Name",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "DataFactory Name",
            "name": "factory_name",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": true,
            "required": false,
            "sequence": 6,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "create_run,list_triggers,start_trigger,stop_trigger,get_pipeline,list_pipelines,cancel_run",
            "sysId": "deb66f71678b41c6aa4d3371470ede53"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 5",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide the Azure Datafactory Pipeline Name",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Pipeline Name",
            "name": "pipeline_name",
            "noSpaceIfHidden": false,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": true,
            "required": false,
            "sequence": 7,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "create_run,get_pipeline",
            "sysId": "306e6af525ab429384b83aba575e4656"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Script Field 1",
            "fieldType": "Script",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide the pipeline run time parameters in the script library ",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Pipeline Parameters",
            "name": "pipeline_parameters",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": false,
            "sequence": 8,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "create_run",
            "sysId": "ad7ff16ae90c4bd68f5d355de057f595"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 6",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide the pipeline run ID",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Run ID",
            "name": "run_id",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": true,
            "required": false,
            "sequence": 9,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "cancel_run",
            "sysId": "6660354a70ef445b8fc510f763821970"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Boolean Field 3",
            "fieldType": "Boolean",
            "fieldValue": "false",
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": null,
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Restart Pipeline",
            "name": "restart_flag",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": false,
            "sequence": 10,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "create_run",
            "sysId": "c4766936443b4aef8ee005c844f1dce1"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Boolean Field 1",
            "fieldType": "Boolean",
            "fieldValue": "true",
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "check if the pipeline needs to be restarted from a Failure",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Start From Failure",
            "name": "start_from_failure",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": false,
            "sequence": 11,
            "showIfField": "Boolean Field 3",
            "showIfFieldValue": "true",
            "sysId": "4e684c2e8e914ca990dc87de2024cf97"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 7",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Specify if it needs to be restarted from a specific activity",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Start Activity Name",
            "name": "start_activity_name",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": false,
            "sequence": 12,
            "showIfField": "Boolean Field 1",
            "showIfFieldValue": "false",
            "sysId": "e0aa89db58e74c1e9a43320322ccfc08"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 8",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Provide the Run ID for Restart",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Run ID for Restart",
            "name": "run_id_restart",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": true,
            "required": false,
            "sequence": 13,
            "showIfField": "Boolean Field 3",
            "showIfFieldValue": "true",
            "sysId": "79bfbae9e8de457da80f225642ce6ea4"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Text Field 9",
            "fieldType": "Text",
            "fieldValue": null,
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "Trigger Name to be provided for the start of a pipline",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Trigger Name",
            "name": "trigger_name",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": true,
            "required": false,
            "sequence": 14,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "start_trigger,stop_trigger",
            "sysId": "29209eb6acff422495f2c97ca9ba2a65"
        },
        {
            "arrayNameTitle": null,
            "arrayValueTitle": null,
            "booleanNoValue": null,
            "booleanValueType": "true/false",
            "booleanYesValue": null,
            "choiceAllowEmpty": false,
            "choiceAllowMultiple": false,
            "choiceSortOption": "Sequence",
            "choices": [],
            "defaultListView": false,
            "fieldLength": null,
            "fieldMapping": "Boolean Field 2",
            "fieldType": "Boolean",
            "fieldValue": "true",
            "formColumnSpan": 1,
            "formEndRow": false,
            "formStartRow": false,
            "hint": "True for ARMPolling, False for no polling, or a polling object for personal polling strategy",
            "intFieldMax": null,
            "intFieldMin": null,
            "label": "Polling",
            "name": "polling",
            "noSpaceIfHidden": true,
            "requireIfField": null,
            "requireIfFieldValue": null,
            "requireIfVisible": false,
            "required": false,
            "sequence": 15,
            "showIfField": "Choice Field 1",
            "showIfFieldValue": "start_trigger,stop_trigger",
            "sysId": "1b5a486c68ed49fc97bce801ff585c4e"
        }
    ],
    "name": "Azure-DataFactory",
    "outputFailureOnly": false,
    "outputReturnFile": null,
    "outputReturnNline": "100",
    "outputReturnSline": "1",
    "outputReturnText": null,
    "outputReturnType": "NONE",
    "outputType": "STDOUT",
    "runtimeDir": null,
    "script": "#!/opt/universal/python3.6/bin/python3\n###########################################################\n#    Name: Azure Data Facory_UT.py\n#\n#    Purpose: This task will support the below functionalities in Azure data factory\n#           1. Run a Azure datafactory Pipeline\n#           2. Get a pipeline info\n#           3. List all pipelines\n#           4. Cancel Pipeline run\n#           5. List Factory by Resource group\n#           6. Start Trigger\n#           7. Stop Trigger\n#           8. List trigger by Factory \n#\n#    Prerequisites:\n#     - Universal Agent for Windows/Linux\n#     - Requires the Python modules\n#     - Note: module can be added using pip\n#           - azure-mgmt-resource & azure-mgmt-datafactory\n#\nversion = \"1.0\"\n#           Version History:    0.1     Ravi Murugesan     16-Nov-2020     Initial Version\n#\n#\nversion = \"0.1\"\n\n# Used modules\n\nimport re\nimport glob\nimport sys, os\nimport logging\nimport argparse\nfrom azure.common.credentials import ServicePrincipalCredentials\nfrom azure.mgmt.resource import ResourceManagementClient\nfrom azure.mgmt.datafactory import DataFactoryManagementClient\nfrom azure.mgmt.datafactory.models import *\nfrom datetime import datetime,timedelta\nimport time\nimport json\n# -- loglevel settings INFO,DEBUG, WARNING, ERROR, CRITICAL\n\nlogging.basicConfig(level=logging.INFO, format=' %(asctime)s - %(levelname)s - %(message)s')\n\ndef main():\n    Set_Variables()  # -- Set Variables from Universal Task Form or Command Line Input\n    if args.datafactory_function == \"create_run\":\n        create_run()\n    elif args.datafactory_function == \"get_pipeline\":\n        get_pipeline()\n    elif args.datafactory_function == \"list_pipelines\":\n        list_pipelines()\n    elif args.datafactory_function == \"cancel_run\":\n        cancel_run()\n    elif args.datafactory_function == \"list_factories\":\n        list_factories()\n    elif args.datafactory_function == \"start_trigger\":\n        start_trigger()\n    elif args.datafactory_function == \"stop_trigger\":\n        stop_trigger()\n    elif args.datafactory_function == \"list_triggers\":\n        list_triggers()\n#####################################################################################\n# --\ndef Set_Variables():\n    parser = argparse.ArgumentParser(description='Purpose : Execute a Azure Data Factory function')\n    # ## --> Azure Datafactory Connection Settings:\n    parser.add_argument(\"--azure_client_id\", default=\"${_credentialUser('${ops_df_client_id}')}\")\n    parser.add_argument(\"--azure_client_secret\", default=\"${_credentialPwd('${ops_df_client_id}')}\")\n\n    # ## --> Azure DataFactory Task Settings\n    parser.add_argument(\"--azure_location\", default=\"${ops_df_azure_location}\")\n    parser.add_argument(\"--tenant_id\", default=\"${ops_df_tenant_id}\")\n    parser.add_argument(\"--subscription_id\", default=\"${ops_df_subscription_id}\")\n    parser.add_argument(\"--resource_group_name\", default=\"${ops_df_resource_group_name}\")\n    parser.add_argument(\"--datafactory_function\", default=\"${ops_df_datafactory_function}\")\n    parser.add_argument(\"--factory_name\", default=\"${ops_df_factory_name}\")\n    parser.add_argument(\"--pipeline_name\", default=\"${ops_df_pipeline_name}\")\n    parser.add_argument(\"--run_id\", default=\"${ops_df_run_id}\")\n    parser.add_argument(\"--start_from_failure\", default=\"${ops_df_start_from_failure}\")\n    parser.add_argument(\"--start_activity_name\", default=\"${ops_df_start_activity_name}\")\n    parser.add_argument(\"--run_id_restart\", default=\"${ops_df_run_id_restart}\")\n    parser.add_argument(\"--trigger_name\", default=\"${ops_df_trigger_name}\")\n    parser.add_argument(\"--polling\", default=\"${ops_df_polling}\")\n    parser.add_argument(\"--pipeline_parameters\", default=\"${ops_df_pipeline_parameters}\")\n    parser.add_argument(\"--restart_flag\", default=\"${ops_df_restart_flag}\")\n    ################################################################################################\n    # ## --\n    global args\n    args = parser.parse_args()\n    # -- Setup Logging\n    logging.info(\"Executing version \" + version + \" with the following paramaters\")\n    logging.info(args)\n# --\n# --\n\n##############This Function is to list pipeline detail from the Azure Data Factory\ndef list_pipelines():\n    try:\n        logging.info(\"List Pipeline - Initiating Datafactory call\")\n        credentials = ServicePrincipalCredentials(client_id=args.azure_client_id, secret=args.azure_client_secret, tenant=args.tenant_id)\n        adf_client = DataFactoryManagementClient(credentials, args.subscription_id)\n        pipeline_details =adf_client.pipelines.list_by_factory(args.resource_group_name,args.factory_name)\n        logging.info(\"***Pipelines listed in STDOUT for datafactory: \"+args.factory_name+\"***\")\n        #print(pipeline_details)\n        for piplines in pipeline_details:\n            print(piplines)\n    except Exception as e:\n        logging.error(\"Error in listing the details from Azure Data Factory :\"+str(pipeline_details))\n        logging.error(e)\n        sys.exit(1)\n#\n#\n##############This Function is to start a pipeline from a trigger##########################\ndef start_trigger():\n    try:\n        logging.info(\"Start a trigger - Initiating Datafactory call\")\n        credentials = ServicePrincipalCredentials(client_id=args.azure_client_id, secret=args.azure_client_secret, tenant=args.tenant_id)\n        adf_client = DataFactoryManagementClient(credentials, args.subscription_id)\n        if(args.polling==\"true\"):\n            trigger_polling=True\n        else:\n            trigger_polling=False\n        start_trigger_details=adf_client.triggers.start(args.resource_group_name,args.factory_name,args.trigger_name,\n                                                        raw=True,polling=trigger_polling)\n        logging.info(\"**Trigger started successfully: \"+args.trigger_name)\n        print(start_trigger_details)\n    except Exception as e:\n        logging.error(\"Error in starting the trigger in Azure Data Factory :\"+str(start_trigger_details))\n        logging.error(e)\n        sys.exit(1)\n#\n#\n##############This Function is to stop a pipeline from a trigger##########################\ndef stop_trigger():\n    try:\n        logging.info(\"Stop a trigger - Initiating Datafactory call\")\n        credentials = ServicePrincipalCredentials(client_id=args.azure_client_id, secret=args.azure_client_secret, tenant=args.tenant_id)\n        adf_client = DataFactoryManagementClient(credentials, args.subscription_id)\n        if(args.polling==\"true\"):\n            trigger_polling=True\n        else:\n            trigger_polling=False\n        stop_trigger_details=adf_client.triggers.stop(args.resource_group_name,args.factory_name,args.trigger_name,\n                                                        raw=True,polling=trigger_polling)\n        logging.info(\"**Trigger stopped successfully: \"+args.trigger_name)\n        print(stop_trigger_details)\n    except Exception as e:\n        logging.error(\"Error in Stopping the trigger in Azure Data Factory :\"+str(stop_trigger_details))\n        logging.error(e)\n        sys.exit(1)\n#\n#\n##############This Function is to list trigger by Factory Namer##########################\ndef list_triggers():\n    try:\n        logging.info(\"List Trigger by Factory Name - Initiating Datafactory call\")\n        credentials = ServicePrincipalCredentials(client_id=args.azure_client_id, secret=args.azure_client_secret, tenant=args.tenant_id)\n        adf_client = DataFactoryManagementClient(credentials, args.subscription_id)\n        list_trigger_details=adf_client.triggers.list_by_factory(args.resource_group_name,args.factory_name)\n        logging.info(\"**Listing Trigger for Factory Name(STDOUT): \"+args.factory_name+\"******\")\n        for trigger in list_trigger_details:\n            print(trigger)\n    except Exception as e:\n        logging.error(\"Error in listing the trigger in Azure Data Factory :\"+str(list_trigger_details))\n        logging.error(e)\n        sys.exit(1)\n#\n#\n##############This Function is to list Factories by Resource group##########################\ndef list_factories():\n    try:\n        logging.info(\"List the Factory details - Initiating Datafactory call\")\n        credentials = ServicePrincipalCredentials(client_id=args.azure_client_id, secret=args.azure_client_secret, tenant=args.tenant_id)\n        adf_client = DataFactoryManagementClient(credentials, args.subscription_id)\n        list_factories_details=adf_client.factories.list_by_resource_group(args.resource_group_name)\n        logging.info(\"***Factories details listed in resource group: \"+args.resource_group_name)\n        for list_factory in list_factories_details:\n            print(list_factory)\n    except Exception as e:\n        logging.error(\"Error in Fetching the factory details in Azure Data Factory :\"+str(list_factories_details))\n        logging.error(e)\n        sys.exit(1)\n#\n#\n##############This Function is to Cancel pipeline run from the Azure Data Factory\ndef cancel_run():\n    try:\n        logging.info(\"Cancel Pipeline Execution - Initiating Datafactory call\")\n        credentials = ServicePrincipalCredentials(client_id=args.azure_client_id, secret=args.azure_client_secret, tenant=args.tenant_id)\n        adf_client = DataFactoryManagementClient(credentials, args.subscription_id)\n        cancel_pipeline_details=adf_client.pipeline_runs.cancel(args.resource_group_name,args.factory_name,args.run_id)\n        logging.info(\"***Pipline with run Id : \"+args.run_id+\"is cancelled******\")\n        print(cancel_pipeline_details)\n    except Exception as e:\n        logging.error(\"Error in cancelling the pipeline execution in Azure Data Factory :\"+str(cancel_pipeline_details))\n        logging.error(e)\n        sys.exit(1)\n#\n#\n##############This Function is to get a pipeline details from the Azure Data Factory ************\ndef get_pipeline():\n    try:\n        logging.info(\"Get Pipeline - Initiating Datafactory call\")\n        credentials = ServicePrincipalCredentials(client_id=args.azure_client_id, secret=args.azure_client_secret, tenant=args.tenant_id)\n        adf_client = DataFactoryManagementClient(credentials, args.subscription_id)\n        pipeline_details =adf_client.pipelines.get(args.resource_group_name,args.factory_name,args.pipeline_name,raw=False)\n        logging.info(\"***Details of the Pipeline Mentioned in STDOUT (if there is a match)***\")\n        print(pipeline_details)\n    except Exception as e:\n        logging.error(\"Error in Getting the details from Azure Data Factory :\"+str(pipeline_details))\n        logging.error(e)\n        sys.exit(1)\n#\n#\n###############This function will trigger a Azure Datafactory pipeline run #################################\ndef create_run():\n    try:\n        logging.info(\"Initiating to create a pipeline run\")\n        #Create a data factory\n        subscription_id = args.subscription_id\n        if not args.pipeline_parameters:\n            logging.info(\"Parameters is set to None\")\n            parameters_data=None\n        else:\n            params = open(r'''${_scriptPath('${ops_df_pipeline_parameters}')}''', 'r')\n            parameters_data = params.read()\n            print(\"Parameters :\",parameters_data)\n        credentials = ServicePrincipalCredentials(client_id=args.azure_client_id, secret=args.azure_client_secret, tenant=args.tenant_id)\n        adf_client = DataFactoryManagementClient(credentials, subscription_id)\n        #####For a New Pipeline Run########################\n        if (args.restart_flag == \"false\"):\n            response_pipeline_run = adf_client.pipelines.create_run(args.resource_group_name, args.factory_name,args.pipeline_name,parameters=parameters_data)\n       ## For a pipeline run that needs a restart - Restart from failure or a specific activity\n        elif (args.restart_flag == \"true\"):\n            if(args.start_from_failure == \"true\"):\n                response_pipeline_run = adf_client.pipelines.create_run(\n                args.resource_group_name, args.factory_name,args.pipeline_name,\n                reference_pipeline_run_id=args.run_id_restart,is_recovery=True,\n                start_from_failure=True)\n            elif(args.start_from_failure == \"false\" and args.start_activity_name!=\"\"):\n                response_pipeline_run = adf_client.pipelines.create_run(\n                    args.resource_group_name, args.factory_name,args.pipeline_name,\n                    reference_pipeline_run_id=args.run_id_restart,is_recovery=True,\n                    start_from_failure=False,start_activity_name=args.start_activity_name)\n\n        logging.info(\"Run ID: \"+ response_pipeline_run.run_id)\n        monitor_status=0\n        inprogress_flag=False\n        queued_flag=False\n        while True:\n            pipeline_run = adf_client.pipeline_runs.get(args.resource_group_name,args.factory_name,response_pipeline_run.run_id)\n            ############To provide an update with a pipeline execution status#################\n            if(monitor_status==0):\n                logging.info(\"Pipeline run triggered with Run ID : \"+response_pipeline_run.run_id)\n                #logging.info(\"Pipeline Execution status: \"+pipeline_run.status)\n                monitor_status=monitor_status+1\n            if (pipeline_run.status == \"InProgress\" or pipeline_run.status == \"Queued\"):\n                if pipeline_run.status==\"InProgress\":\n                    if not inprogress_flag:\n                        logging.info(\"Pipeline Execution status: In-progress\")\n                        inprogress_flag=True\n                elif pipeline_run.status==\"Queued\":\n                    if not queued_flag:\n                        logging.info(\"Pipeline Execution status: Queued\")\n                        queued_flag=False\n                time.sleep(10)\n            elif (pipeline_run.status == \"Succeeded\"):\n                logging.info(\"Pipeline : \"+args.pipeline_name+\" execution completed with status Success\")\n                #print(\"\\n\\tPipeline run status: {}\".format(pipeline_run.status))\n                #last_updated_after=datetime.now() - timedelta(1)\n                #last_updated_before=datetime.now() + timedelta(1)\n                filter_params = RunFilterParameters(\n                    last_updated_after=datetime.now() - timedelta(1), last_updated_before=datetime.now() + timedelta(1))\n                query_response = adf_client.activity_runs.query_by_pipeline_run(\n                    args.resource_group_name, args.factory_name, pipeline_run.run_id, filter_params)\n                #print(\"List length:\",len(query_response.value))\n                for i in range(len(query_response.value)):\n                    print(query_response.value[i])\n                break\n            elif (pipeline_run.status == \"Failed\" or pipeline_run.status == \"Cancelled\"):\n                logging.info(\"Pipeline : \"+args.pipeline_name+\" execution completed with status: \"+pipeline_run.status)\n                #print(\"\\n\\tPipeline run status: {}\".format(pipeline_run.status))\n                for i in range(len(query_response.value)):\n                    print(query_response.value[i])\n                sys.exit(1)\n    except Exception as e:\n        logging.error(\"Error in creating/monitoring the pipeline run :\"+str(response_pipeline_run))\n        logging.error(\"Monitor Pipeline execution response: \"+str(pipeline_run))\n        logging.error(e)\n        sys.exit(1)\n# Start the main method\nmain()\n\n",
    "scriptTypeWindows": "vbs",
    "scriptUnix": null,
    "scriptWindows": null,
    "sysId": "4da0413313f24091810d09a081efdff6",
    "useCommonScript": true,
    "variablePrefix": "DF",
    "waitForOutput": false
}